<!DOCTYPE html>
<html lang="en">
        <head>
                <meta charset="utf-8">
                        <meta content="width=device-width, initial-scale=1.0" name="viewport">
                                <meta content="ie=edge" http-equiv="X-UA-Compatible">
                                        <title>
                                                Node.js Socket.io Chat Application
                                        </title>
                                        <link href="/vendor/bootstrap.min.css" rel="stylesheet">
                                                <script src="/vendor/jquery.min.js">
                                                </script>
                                                <script src="/vendor/socket.io.js">
                                                </script>
                                                <script src="/vendor/vue.min.js">
                                                </script>
                                                <script src="/js/home.js">
                                                </script>
                                        </link>
                                </meta>
                        </meta>
                </meta>
        </head>
        <body>
                <style>
                        .chatArea
      {
         height: 25vh;
         overflow: scroll;
      }
      .well
      {
         text-align: center;
      }
      .well div
      {
         width: 100px;
      }
                </style>
                <div class="container">
                        <h1 class="jumbotron">
                                Node js Socket io Chat Application
         <% if(!everyauth.loggedIn) { %>
                                <h4>
                                        Faça
                                        <a href="/login">
                                                login
                                        </a>
                                        (
                                        <a href="/auth/facebook">
                                                Facebook
                                        </a>
                                        ) 
                  ou
                                        <a href="/register">
                                                registe-se
                                        </a>
                                        .
                                </h4>
                                <% } else { %>
                                <h4>
                                        Bem-vindo, 
               <% if(everyauth.user) { %> 
               <%    user = everyauth.user; %>
               <% } else if(everyauth.facebook) { %>
               <%    user = everyauth.facebook.user; %>
               <% } %>

               <%= user.name %>!
                                </h4>
                                <a href="/logout">
                                        Logout
                                </a>
                                <div class="row" style="margin-top: 70px;">
                                        <div class="col-md-6">
                                                <select id="comboUser">
                                                        <option v-bind:value="user.username" v-for="user in users">
                                                                {{ user.name }} ({{ user.username }})
                                                        </option>
                                                </select>
                                                <script>
                                                        new Vue({
							  el: '#comboUser',
							  data: {
							    users: <%- JSON.stringify(users) %>
							  }
							})
                                                </script>
                                        </div>
                                        <div class="col-md-6">
                                                <h3>
                                                        Mensagens pessoais
                                                </h3>
                                                <div class="chatArea" id="prChat">
                                                        <% for(var i = 0, len = prMessages.length; i < len ; i++) { %>
                                                        <div class="well">
                                                                <p>
                                                                        <%= prMessages[i].sender %>
                                                                </p>
                                                                <p>
                                                                        <%= prMessages[i].text %>
                                                                </p>
                                                                <p>
                                                                        <%= prMessages[i].receiver %>
                                                                </p>
                                                                <p>
                                                                        <%= prMessages[i].timestamp %>
                                                                </p>
                                                        </div>
                                                        <% } %>
                                                </div>
                                                <form id="prForm">
                                                        <div class="form-group">
                                                                <textarea class="form-control" cols="5" id="prTxt" rows="5">
                                                                </textarea>
                                                        </div>
                                                        <div class="form-group">
                                                                <button class="btn btn-success" type="submit">
                                                                        Send
                                                                </button>
                                                        </div>
                                                </form>
                                        </div>
                                </div>
                                <% } %>
                        </h1>
                        <div class="row" style="margin-top: 70px;">
                                <div class="col-md-4">
                                </div>
                                <div class="col-md-6">
                                        <h3>
                                                Chat público
                                        </h3>
                                        <div class="chatArea" id="pubChat">
                                                <% for(var i = 0, len = pubMessages.length; i < len ; i++) { %>
                                                <div class="well">
                                                        <div style="float:left;">
                                                                <% if(pubMessages[i].name) { %>
                           <%= pubMessages[i].name %>
                        <% } else { %>
                           Desconhecido
                        <% } %>
                                                        </div>
                                                        <div style="display: inline-block; margin:0 auto;">
                                                                <%= pubMessages[i].text %>
                                                        </div>
                                                        <div style="float:right;">
                                                                <i>
                                                                        <%= pubMessages[i].timestamp %>
                                                                </i>
                                                        </div>
                                                </div>
                                                <% } %>
                                        </div>
                                        <form id="pubForm">
                                                <div class="form-group">
                                                        <textarea class="form-control" cols="5" id="pubTxt" rows="5">
                                                        </textarea>
                                                </div>
                                                <div class="form-group">
                                                        <button class="btn btn-success" type="submit">
                                                                Send
                                                        </button>
                                                </div>
                                        </form>
                                </div>
                        </div>
                </div>
        </body>
</html>
